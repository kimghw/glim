# π Ouster λΌμ΄λ‹¤ μ›Ή λ€μ‹λ³΄λ“

Flask κΈ°λ° μ›Ή μΈν„°νμ΄μ¤λ΅ Ouster λΌμ΄λ‹¤λ¥Ό μ μ–΄ν•κ³  λ¨λ‹ν„°λ§ν•©λ‹λ‹¤.

## π“‹ κΈ°λ¥

### 1. μ„Όμ„ μƒνƒ λ¨λ‹ν„°λ§
- μ‹¤μ‹κ°„ μ„Όμ„ μ—°κ²° μƒνƒ ν™•μΈ
- μ„Όμ„ λ¨λΈ, S/N, νμ›¨μ–΄ μ •λ³΄ ν‘μ‹
- IP μ£Όμ† λ° λ„¤νΈμ›ν¬ μƒνƒ

### 2. λ“λΌμ΄λ²„ μ μ–΄
- ROS2 λ“λΌμ΄λ²„ μ‹μ‘/μ¤‘μ§€
- λ“λΌμ΄λ²„ ν”„λ΅μ„Έμ¤ μƒνƒ ν™•μΈ
- PID λ¨λ‹ν„°λ§

### 3. ROS2 ν† ν”½ λ¨λ‹ν„°λ§
- ν™μ„± ν† ν”½ λ¦¬μ¤νΈ μ‹¤μ‹κ°„ ν‘μ‹
- ν† ν”½ κ°μ ν™•μΈ

### 4. λ°μ΄ν„° λ…Ήν™”
- νμΌλ… μ§€μ • λλ” μλ™ μƒμ„±
- μ‹κ°„ μ ν• λ…Ήν™” μ§€μ›
- Raw packets λλ” μ „μ²΄ ν† ν”½ μ„ νƒ
- λ…Ήν™” μ¤‘ μ‹¤μ‹κ°„ μƒνƒ ν‘μ‹

### 5. λ°μ΄ν„° μ¬μƒ
- λ…Ήν™”λ νμΌ λ©λ΅ ν‘μ‹
- ν΄λ¦­ ν• λ²μΌλ΅ μ¬μƒ μ‹μ‘
- νμΌ ν¬κΈ°, μƒμ„±/μμ • μ‹κ°„ μ •λ³΄

### 6. νμΌ κ΄€λ¦¬
- λ…Ήν™” νμΌ μ‚­μ 
- νμΌ μ •λ³΄ ν™•μΈ

## π€ μ‹¤ν–‰ λ°©λ²•

### λΉ λ¥Έ μ‹μ‘

```bash
cd /home/kimghw/glim/ouster_setup/web
./start_web.sh
```

λΈλΌμ°μ €μ—μ„ `http://localhost:5000` μ ‘μ†

### μλ™ μ‹¤ν–‰

```bash
# μμ΅΄μ„± μ„¤μΉ
pip3 install -r requirements.txt

# μ›Ή μ„λ²„ μ‹¤ν–‰
python3 app.py
```

## π“± μ‚¬μ© λ°©λ²•

### 1. μ„Όμ„ λ¨λ‹ν„°λ§
- λ€μ‹λ³΄λ“λ” 3μ΄λ§λ‹¤ μλ™μΌλ΅ μƒνƒλ¥Ό κ°±μ‹ ν•©λ‹λ‹¤
- μ„Όμ„ μƒνƒ, λ“λΌμ΄λ²„ μƒνƒ, ROS2 ν† ν”½μ„ μ‹¤μ‹κ°„μΌλ΅ ν™•μΈν•  μ μμµλ‹λ‹¤

### 2. λ“λΌμ΄λ²„ μ‹μ‘
1. "λ“λΌμ΄λ²„ μ‹μ‘" λ²„νΌ ν΄λ¦­
2. RViz μ°½μ΄ μλ™μΌλ΅ μ—΄λ¦½λ‹λ‹¤
3. λ“λΌμ΄λ²„ μƒνƒκ°€ "μ‹¤ν–‰ μ¤‘"μΌλ΅ λ³€κ²½λ©λ‹λ‹¤

### 3. λ°μ΄ν„° λ…Ήν™”
1. (μ„ νƒ) νμΌλ… μ…λ ¥ (λΉ„μ›λ‘λ©΄ μλ™ μƒμ„±)
2. (μ„ νƒ) λ…Ήν™” μ‹κ°„(μ΄) μ…λ ¥ (λΉ„μ›λ‘λ©΄ λ¬΄μ ν•)
3. (μ„ νƒ) "λ¨λ“  ν† ν”½ λ…Ήν™”" μ²΄ν¬λ°•μ¤ μ„ νƒ
4. "λ…Ήν™” μ‹μ‘" λ²„νΌ ν΄λ¦­
5. μ¤‘μ§€ν•λ ¤λ©΄ "λ…Ήν™” μ¤‘μ§€" λ²„νΌ ν΄λ¦­

### 4. λ°μ΄ν„° μ¬μƒ
1. λ…Ήν™” νμΌ λ©λ΅μ—μ„ μ›ν•λ” νμΌ μ°ΎκΈ°
2. "β–¶οΈ μ¬μƒ" λ²„νΌ ν΄λ¦­
3. RVizμ—μ„ λ°μ΄ν„° ν™•μΈ
4. μ¤‘μ§€ν•λ ¤λ©΄ "μ¬μƒ μ¤‘μ§€" λ²„νΌ ν΄λ¦­

### 5. νμΌ μ‚­μ 
1. λ…Ήν™” νμΌ λ©λ΅μ—μ„ μ‚­μ ν•  νμΌ μ°ΎκΈ°
2. "π—‘οΈ μ‚­μ " λ²„νΌ ν΄λ¦­
3. ν™•μΈ λ€ν™”μƒμμ—μ„ ν™•μΈ

## π”§ API μ—”λ“ν¬μΈνΈ

### GET /api/status
μ „μ²΄ μ‹μ¤ν… μƒνƒ μ΅°ν

**μ‘λ‹µ:**
```json
{
  "sensor": {
    "status": "online",
    "ip": "192.168.10.10",
    "model": "OS-1-32-U2-SR",
    "serial": "122413001532",
    "firmware": "v3.1.0"
  },
  "driver": {
    "active": true,
    "pid": 12345
  },
  "recording": {
    "active": false,
    "pid": null
  },
  "replay": {
    "active": false,
    "pid": null
  },
  "ros_topics": {
    "available": true,
    "topics": ["/ouster/points", ...],
    "count": 9
  },
  "files": [...]
}
```

### POST /api/driver/start
λ“λΌμ΄λ²„ μ‹μ‘

### POST /api/driver/stop
λ“λΌμ΄λ²„ μ¤‘μ§€

### POST /api/record/start
λ…Ήν™” μ‹μ‘

**μ”μ²­:**
```json
{
  "filename": "my_recording",
  "duration": "60",
  "record_all": false
}
```

### POST /api/record/stop
λ…Ήν™” μ¤‘μ§€

### POST /api/replay/start
μ¬μƒ μ‹μ‘

**μ”μ²­:**
```json
{
  "bag_path": "/home/kimghw/glim/rosbag_data/my_recording"
}
```

### POST /api/replay/stop
μ¬μƒ μ¤‘μ§€

### POST /api/files/delete
νμΌ μ‚­μ 

**μ”μ²­:**
```json
{
  "bag_path": "/home/kimghw/glim/rosbag_data/my_recording"
}
```

## π“ νμΌ κµ¬μ΅°

```
web/
β”β”€β”€ app.py                 # Flask μ• ν”λ¦¬μΌ€μ΄μ…
β”β”€β”€ templates/
β”‚   β””β”€β”€ index.html        # μ›Ή μΈν„°νμ΄μ¤
β”β”€β”€ requirements.txt      # Python μμ΅΄μ„±
β”β”€β”€ start_web.sh          # μ‹¤ν–‰ μ¤ν¬λ¦½νΈ
β””β”€β”€ README.md             # μ΄ νμΌ
```

## β™οΈ μ„¤μ •

### μ„Όμ„ IP λ³€κ²½
`app.py`μ `SENSOR_IP` λ³€μλ¥Ό μμ •:

```python
SENSOR_IP = '192.168.10.10'  # μ›ν•λ” IPλ΅ λ³€κ²½
```

### λ°μ΄ν„° μ €μ¥ κ²½λ΅ λ³€κ²½
`app.py`μ `DATA_DIR` λ³€μλ¥Ό μμ •:

```python
DATA_DIR = Path('/home/kimghw/glim/rosbag_data')  # μ›ν•λ” κ²½λ΅λ΅ λ³€κ²½
```

### ν¬νΈ λ³€κ²½
`app.py`μ λ§μ§€λ§‰ μ¤„ μμ •:

```python
app.run(host='0.0.0.0', port=5000, ...)  # port λ³€κ²½
```

## π” λ¬Έμ  ν•΄κ²°

### μ›Ή μ„λ²„κ°€ μ‹μ‘λμ§€ μ•μ
```bash
# μμ΅΄μ„± μ¬μ„¤μΉ
pip3 install -r requirements.txt --upgrade

# ν¬νΈ μ‚¬μ© μ¤‘μΈμ§€ ν™•μΈ
lsof -i :5000

# λ‹¤λ¥Έ ν¬νΈλ΅ μ‹¤ν–‰
# app.pyμ ν¬νΈ λ²νΈ λ³€κ²½
```

### μ„Όμ„ μƒνƒκ°€ μ¤ν”„λΌμΈμΌλ΅ ν‘μ‹λ¨
```bash
# μ„Όμ„ μ—°κ²° ν™•μΈ
ping 192.168.10.10

# λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤ ν™•μΈ
ip addr show

# Static IP μ¬μ„¤μ •
cd ../scripts
sudo ./set_ouster_static_ip.sh
```

### λ“λΌμ΄λ²„κ°€ μ‹μ‘λμ§€ μ•μ
```bash
# ROS2 ν™κ²½ ν™•μΈ
source /opt/ros/jazzy/setup.bash
ros2 pkg list | grep ouster

# μλ™μΌλ΅ λ“λΌμ΄λ²„ ν…μ¤νΈ
cd ../scripts
./run_driver.sh
```

### λ…Ήν™”/μ¬μƒμ΄ μ‘λ™ν•μ§€ μ•μ
```bash
# μ €μ¥ λ””λ ‰ν† λ¦¬ κ¶ν• ν™•μΈ
ls -la /home/kimghw/glim/rosbag_data

# λ””λ ‰ν† λ¦¬ μƒμ„±
mkdir -p /home/kimghw/glim/rosbag_data
```

## π μ™Έλ¶€ μ ‘μ†

κ°™μ€ λ„¤νΈμ›ν¬μ λ‹¤λ¥Έ μ»΄ν“¨ν„°μ—μ„ μ ‘μ†ν•λ ¤λ©΄:

1. μ„λ²„ μ»΄ν“¨ν„°μ IP ν™•μΈ:
```bash
hostname -I
```

2. λΈλΌμ°μ €μ—μ„ μ ‘μ†:
```
http://[μ„λ²„IP]:5000
```

μ: `http://192.168.1.100:5000`

## π“ μ£Όμμ‚¬ν•­

- μ›Ή λ€μ‹λ³΄λ“λ” κ°λ° λ¨λ“λ΅ μ‹¤ν–‰λ©λ‹λ‹¤
- ν”„λ΅λ•μ… ν™κ²½μ—μ„λ” WSGI μ„λ²„(Gunicorn λ“±) μ‚¬μ© κ¶μ¥
- λ™μ‹μ— μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈκ°€ μ μ–΄ν•λ©΄ μ¶©λ κ°€λ¥
- λ€μ©λ‰ νμΌ μ¬μƒ μ‹ μ‹μ¤ν… λ¦¬μ†μ¤ ν™•μΈ

## π“ μ°Έκ³ 

- [Flask λ¬Έμ„](https://flask.palletsprojects.com/)
- [ROS2 λ¬Έμ„](https://docs.ros.org/en/jazzy/)
- [Ouster ROS](https://github.com/ouster-lidar/ouster-ros)
